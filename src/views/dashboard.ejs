<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Semana Acad√™mica</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logout-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
            text-decoration: none;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .card h3 {
            margin-bottom: 15px;
            color: #667eea;
            font-size: 1.3rem;
        }

        .card p {
            margin-bottom: 20px;
            color: #666;
            line-height: 1.5;
        }

        .card-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            text-decoration: none;
            display: inline-block;
            transition: opacity 0.3s;
        }

        .card-btn:hover {
            opacity: 0.9;
        }

        .role-info {
            background: #e8f5e8;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .access-denied {
            background: #fdf2f2;
            border-left: 4px solid #e74c3c;
            color: #c0392b;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>üéì Dashboard - Semana Acad√™mica</h1>
        <div class="user-info">
            <span id="userName">
                <%= typeof user !=='undefined' ? user.username : 'Usu√°rio' %>
            </span>
            <a href="auth/logout" class="logout-btn">Sair</a>
        </div>
    </div>

    <div class="container">
        <div id="loading" style="text-align: center; padding: 40px;">
            <p>Verificando permiss√µes...</p>
        </div>

        <div id="roleInfo" class="role-info" style="display: none;">
            <strong>Seu papel:</strong> <span id="userRole"></span>
        </div>

        <div id="accessDenied" class="access-denied" style="display: none;">
            <strong>Acesso Restrito:</strong> Apenas administradores e organizadores podem acessar estas
            funcionalidades.
            Entre em contato com o administrador do sistema para solicitar permiss√µes.
        </div>

        <div id="dashboard" class="card-grid" style="display: none;">
            <div class="card">
                <h3>üìã Registrar Participa√ß√£o</h3>
                <p>Escaneie QR codes dos alunos para registrar participa√ß√£o em eventos da semana acad√™mica.</p>
                <a href="/registrar-participacao" class="card-btn">Iniciar Scanner</a>
            </div>

            <div class="card">
                <h3>üèÜ Registrar Vit√≥rias</h3>
                <p>Registre as vit√≥rias das turmas em competi√ß√µes e eventos com pontua√ß√£o por posi√ß√£o.</p>
                <a href="/registrar-vitorias" class="card-btn">Registrar Vit√≥rias</a>
            </div>

            <div class="card">
                <h3>üìä Rankings</h3>
                <p>Visualize os rankings atualizados de alunos e turmas com suas pontua√ß√µes.</p>
                <a href="/rankings" class="card-btn">Ver Rankings</a>
            </div>

            <div class="card">
                <h3>‚öôÔ∏è Gerenciar Dados</h3>
                <p>Cadastre novos alunos, eventos e turmas no sistema da semana acad√™mica.</p>
                <a href="/gerenciar" class="card-btn">Gerenciar</a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"></script>
    <script>
        // Substitua por sua chave p√∫blica do Clerk
        const CLERK_PUBLISHABLE_KEY = '<?= process.env.CLERK_PUBLISHABLE_KEY ?>';

        let clerk;

        // async function initDashboard() {
        //     try {
        //         clerk = window.Clerk;
        //         await clerk.load({ publishableKey: CLERK_PUBLISHABLE_KEY });

        //         // Verificar se est√° logado
        //         if (!clerk.user) {
        //             window.location.href = '/login';
        //             return;
        //         }

        //         // Mostrar nome do usu√°rio
        //         document.getElementById('userName').textContent =
        //             clerk.user.firstName || clerk.user.emailAddresses[0].emailAddress;

        //         // Verificar role
        //         const role = clerk.user.publicMetadata.role;
        //         document.getElementById('userRole').textContent = role || 'N√£o definido';
        //         document.getElementById('roleInfo').style.display = 'block';

        //         // Verificar permiss√µes
        //         const rolesAllowed = ['admin', 'organizador'];
        //         if (!role || !rolesAllowed.includes(role)) {
        //             document.getElementById('accessDenied').style.display = 'block';
        //             document.getElementById('loading').style.display = 'none';
        //         } else {
        //             document.getElementById('dashboard').style.display = 'grid';
        //             document.getElementById('loading').style.display = 'none';
        //         }

        //     } catch (error) {
        //         console.error('Erro ao carregar dashboard:', error);
        //         document.getElementById('loading').innerHTML =
        //             '<p style="color: red;">Erro ao carregar. Recarregue a p√°gina.</p>';
        //     }
        // }

        // async function logout() {
        //     try {
        //         await clerk.signOut();
        //         window.location.href = '/login';
        //     } catch (error) {
        //         console.error('Erro ao fazer logout:', error);
        //     }
        // }

        // Inicializar quando a p√°gina carregar
        // document.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>

</html>